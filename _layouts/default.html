<!DOCTYPE html>
<html>

  {% include head.html %}

  <body>

  <script src="//d3js.org/d3.v3.min.js"></script>
  <script>

  var width = window.innerWidth
           || document.documentElement.clientWidth
           || document.body.clientWidth;

  var height = window.innerHeight
            || document.documentElement.clientHeight
            || document.body.clientHeight;

  function Point(x, y, vel, accel){
    this.x = x;
    this.y = y;
    this.vel = vel;
    this.accel = accel;
  }

  var vertices = d3.range(100).map(function(d) {
    return [Math.random() * width, Math.random() * height];
  });
  
  var voronoi = d3.geom.voronoi()
      .clipExtent([[0, 0], [width, height]]);

  var svg = d3.select("body").append("svg").attr("class", "background")
      .attr("width", width)
      .attr("height", height)

  var path = svg.append("g").selectAll("path");

  svg.selectAll("circle")
      .data(vertices.slice(1))
    .enter().append("circle")
      .attr("transform", function(d) { return "translate(" + d + ")"; })
      .attr("r", 0);

  redraw();
  d3.timer(function() {
    vertices.forEach(function(vertex, i){
      vertex[0] = vertex[0]+Math.sin(new Date().getTime()/3000)
      vertex[1] = vertex[1]+Math.sin(new Date().getTime()/1000)
    })
    // Update circle positions.
    svg.selectAll("circle")
        .data(vertices)
        .attr("transform", function(d) { return "translate(" + d + ")"; });

    // Update voronoi diagram.
    svg.selectAll("path")
        .data(d3.geom.voronoi(vertices))
        .attr("d", function(d) { return "M" + d.join("L") + "Z"; })
  })

  function redraw() {
    path = path
        .data(voronoi(vertices), polygon);

    path.exit().remove();

    path.enter().append("path")
        .attr("class", function(d, i) { return "q" + (i % 9) + "-9"; })
        .attr("d", polygon);

    path.order();
  }

  function polygon(d) {
    return "M" + d.join("L") + "Z";
  }

  </script> 
    {% include header.html %}

    <div class="page-content">
      <div class="wrapper">
        {{ content }}
      </div>
    </div>

    {% include footer.html %}

  </body>

</html>
